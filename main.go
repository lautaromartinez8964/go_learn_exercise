package main

import (
	"fmt"
	"log"
	"strconv"
	"strings"
	"unicode"
	"unicode/utf8"
)

func main() {
	fmt.Println("Hello, VS Code!")

	// ç»ƒä¹ 1ï¼š
	//  ç¼–å†™ä»£ç åˆ†åˆ«å®šä¹‰ä¸€ä¸ªæ•´å‹ã€æµ®ç‚¹å‹ã€å¸ƒå°”å‹ã€å­—ç¬¦ä¸²å‹å˜é‡ï¼Œä½¿ç”¨fmt.Printf()æ­é…%Tåˆ†åˆ«æ‰“å°å‡ºä¸Šè¿°å˜é‡çš„å€¼å’Œç±»å‹ã€‚
	var i int = 10
	var f float64 = 3.14
	var b bool = true
	var s string = "Hello!Goè¯­è¨€"
	fmt.Printf("å˜é‡içš„å€¼ä¸ºï¼š%vï¼Œç±»å‹ä¸ºï¼š%T\n", i, i)
	fmt.Printf("å˜é‡fçš„å€¼ä¸ºï¼š%vï¼Œç±»å‹ä¸ºï¼š%T\n", f, f)
	fmt.Printf("å˜é‡bçš„å€¼ä¸ºï¼š%vï¼Œç±»å‹ä¸ºï¼š%T\n", b, b)
	fmt.Printf("å˜é‡sçš„å€¼ä¸ºï¼š%vï¼Œç±»å‹ä¸ºï¼š%T\n", s, s)
	//  ç¼–å†™ä»£ç ç»Ÿè®¡å‡ºå­—ç¬¦ä¸²"helloæ²™æ²³å°ç‹å­"ä¸­æ±‰å­—çš„æ•°é‡ã€‚
	str1 := "helloæ²™æ²³å°ç‹å­"
	count := 0
	len1 := utf8.RuneCountInString(str1)
	for _, ch := range str1 {
		if ch >= 0x4E00 && ch <= 0x9FA5 { // æ±‰å­—çš„Unicodeç¼–ç èŒƒå›´,å› ä¸ºæ±‰å­—ç±»å‹æ˜¯rune,runeä»£è¡¨unicodeç ç‚¹ï¼ˆæ¯ä¸ªå­—ç¬¦éƒ½æœ‰å¯¹åº”çš„ç ç‚¹ï¼‰
			count++
		}
	}
	fmt.Printf("å­—ç¬¦ä¸²\"%s\"æ€»å­—ç¬¦æ•°ä¸ºï¼š%d\n", str1, len1)
	fmt.Printf("å­—ç¬¦ä¸²\"%s\"ä¸­æ±‰å­—çš„æ•°é‡ä¸ºï¼š%d\n", str1, count)

	//  è®¡ç®—å­—ç¬¦ä¸²æ¯ä¸ªå­—ç¬¦åœ¨UTF-8ç¼–ç ä¸‹å ç”¨çš„å­—èŠ‚æ•°
	for index, char := range str1 {
		// index:å­—ç¬¦çš„èµ·å§‹å­—èŠ‚ç´¢å¼•
		// char:å­—ç¬¦æœ¬èº«ï¼Œç±»å‹æ˜¯rune(int32)

		fmt.Printf("ç´¢å¼•: %d, å­—ç¬¦: %c, ç ç‚¹ (rune): %d, å­—èŠ‚æ•°: %d\n",
			index,
			char,
			char,
			getByteSize(char))
	}

	// ç»ƒä¹ 2ï¼š
	// ä»ä¸€ä¸ªåªæœ‰ä¸€ä¸ªæ•°å­—å‡ºç°ä¸€æ¬¡ï¼Œå…¶ä»–æ•°å­—éƒ½å‡ºç°ä¸¤æ¬¡çš„æ•°å­—å­—ç¬¦ä¸²é‡Œé¢æ‰¾å‡ºå‡ºç°ä¸€æ¬¡çš„æ•°å­—
	str2 := "a52425b"
	singleNum, found := findSingleNumberInString_XOR(str2)
	if found {
		fmt.Printf("å­—ç¬¦ä¸²\"%s\"ä¸­åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—æ˜¯ï¼š%d\n", str2, singleNum)
	} else {
		fmt.Printf("å­—ç¬¦ä¸²\"%s\"ä¸­æ²¡æœ‰æ•°å­—\n", str2)
	}

	str2_2 := "j6767898"
	singleNUm2, found2 := findSingleNumberInString_HashMap(str2_2)
	if found2 {
		fmt.Printf("å­—ç¬¦ä¸²\"%s\"ä¸­åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—æ˜¯ï¼š%d\n", str2_2, singleNUm2)
	} else {
		fmt.Printf("å­—ç¬¦ä¸²\"%s\"ä¸­æ²¡æœ‰åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—\n", str2_2)
	}

	// ç»ƒä¹ 3ï¼šä¹ä¹ä¹˜æ³•è¡¨
	fmt.Println("--- ä¹ä¹ä¹˜æ³•è¡¨ (è·³è¿‡å«6çš„é¡¹) ---")
	// è°ƒç”¨å‡½æ•°æ¥æ‰§è¡Œæ‰“å°ä»»åŠ¡
	printMultiplicationTable_Skip6()
	fmt.Println("---------------------------------")

	// ç»ƒä¹ 4ï¼šæ‰¾å‡ºæ•°ç»„ä¸­å’Œä¸ºæŒ‡å®šå€¼çš„ä¸¤ä¸ªå…ƒç´ çš„ä¸‹æ ‡
	nums4 := []int{1, 8, 3, 5, 7, 0, 8}
	target4 := 8
	fmt.Println("åŸå§‹æ•°ç»„ï¼š", nums4)
	fmt.Println("ç›®æ ‡å’Œ:", target4)
	pairs2 := findSumPairsHash(nums4, target4)
	if len(pairs2) > 0 {
		fmt.Println(pairs2) // è¾“å‡ºå¯èƒ½ä¸º [[0 6] [1 5] [3 2]] é¡ºåºä¸å›ºå®š
	} else {
		fmt.Println("æœªæ‰¾åˆ°ä»»ä½•ç»„åˆã€‚")
	}

	// ç»ƒä¹ 5ï¼šè¾“å‡ºä¸­è‹±æ··åˆå­—ç¬¦ä¸²ä¸­æ¯ä¸ªå•è¯å’Œæ±‰å­—å‡ºç°çš„æ¬¡æ•°ï¼ˆé‡ç‚¹ï¼šå•è¯ç´¯åŠ å™¨ï¼‰
	text := "hello ä¸–ç•Œï¼Œ Hello world! æˆ‘çˆ±æˆ‘å®¶ï¼Œçˆ±ä¸–ç•Œ I love my home"
	fmt.Println("åŸå§‹å­—ç¬¦ä¸²:")
	fmt.Println(text)
	wordCountsMap := countWordsAndChars(text)

	// è§„èŒƒåŒ–è¾“å‡ºç»“æœ
	fmt.Println("ç»Ÿè®¡ç»“æœ:")
	for item, count := range wordCountsMap {
		fmt.Printf("'%s':%d\n", item, count)
	}

	// ç»ƒä¹ 6ï¼šé—­åŒ…
	//åˆ›å»ºä¸€ä¸ªè¯´Helloçš„é—®å€™å‡½æ•°
	greetHello := makeGreeter("Hello")
	greetNihao := makeGreeter("ä½ å¥½")
	fmt.Println(greetHello("Alice"))
	fmt.Println(greetNihao("å°å"))
	// åˆ›å»ºä¸€ä¸ªè¯´â€œä½ å¥½â€çš„é—®å€™å‡½æ•°

	// ç»ƒä¹ 7ï¼šé‡‘å¸åˆ†é…
	fmt.Println("å¼€å§‹è¿›è¡Œé‡‘å¸åˆ†é…...")
	left, err := dispatchCoin(users, coins, distribution)
	// goä¸­æœ€å¸¸è§çš„ä»£ç å—: if err != nil å¦‚æœerrä¸æ˜¯nilï¼Œè¯´æ˜å‘ç”Ÿäº†é”™è¯¯
	if err != nil {
		log.Fatalf("!!!åˆ†é…å¤±è´¥:%v", err)
		// ä½¿ç”¨ log.Fatalf å¯ä»¥æ‰“å°é”™è¯¯ä¿¡æ¯å¹¶ä»¥é0çŠ¶æ€ç é€€å‡ºç¨‹åº
	}
	fmt.Println("åˆ†é…æˆåŠŸï¼")
	fmt.Println("å‰©ä¸‹ï¼š", left)

}

// ç»ƒä¹ 1 è¾…åŠ©å‡½æ•°ï¼Œè®¡ç®—ä¸€ä¸ªruneåœ¨UTF-8ç¼–ç ä¸‹å ç”¨çš„å­—èŠ‚æ•°
func getByteSize(r rune) int {
	if r <= 0x7F {
		return 1
	} else if r <= 0x7FF {
		return 2
	} else if r <= 0xFFFF {
		return 3
	} else {
		return 4
	}
}

// ç»ƒä¹ 2 è¾…åŠ©å‡½æ•°ï¼Œè¿”å›æ•°å­—å­—ç¬¦ä¸²é‡Œåªå‡ºç°ä¸€æ¬¡çš„æ•°å­—
// é¦–å…ˆæ˜¯å­—å…¸å“ˆå¸Œè¡¨ç®—æ³•
func findSingleNumberInString_HashMap(s string) (int, bool) {
	countsmap := make(map[rune]int) //åˆ›å»ºä¸€ä¸ªmapæ¥å­˜å‚¨æ¯ä¸ªæ•°å­—å­—ç¬¦çš„å‡ºç°æ¬¡æ•°ï¼Œkeyæ˜¯runeç±»å‹ï¼Œvalueæ˜¯intç±»å‹
	//éå†å­—ç¬¦ä¸²ä¸­æ¯ä¸€ä¸ªrune
	for _, r := range s {
		if unicode.IsDigit(r) { //åˆ¤æ–­ræ˜¯å¦æ˜¯æ•°å­—å­—ç¬¦
			countsmap[r]++ //å¦‚æœæ˜¯æ•°å­—å­—ç¬¦ï¼Œåˆ™åœ¨mapä¸­å¯¹åº”çš„keyçš„valueåŠ 1
		}
	}

	//éå†mapï¼Œæ‰¾åˆ°åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—å­—ç¬¦
	for r, count := range countsmap {
		r_int := int(r - '0') //å°†runeç±»å‹çš„æ•°å­—å­—ç¬¦è½¬æ¢ä¸ºæ•´æ•°æ•°å­—
		if count == 1 {
			return r_int, true //è¿”å›åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—å’Œtrueè¡¨ç¤ºæ‰¾åˆ°äº†
		}

	}
	return 0, false //å¦‚æœæ²¡æœ‰æ‰¾åˆ°åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—ï¼Œè¿”å›0å’Œfalse
}

// ç›¸æ¯”å­—å…¸å“ˆå¸Œè¡¨ç®—æ³•ï¼Œä½¿ç”¨å¼‚æˆ–è¿ç®—ç¬¦(XOR)ç©ºé—´å¤æ‚åº¦æ›´ä½
// XORæ ¸å¿ƒåŸç†ï¼šç›¸åŒçš„æ•°å­—å¼‚æˆ–ç»“æœä¸º0ï¼Œ0ä¸ä»»ä½•æ•°å­—å¼‚æˆ–ç»“æœä¸ºè¯¥æ•°å­—æœ¬èº«ï¼Œä¸åŒçš„æ•°å­—å¼‚æˆ–ç»“æœä¸º1
//
//	XORè¿˜æœ‰ä¸€ä¸ªé‡è¦æ€§è´¨ï¼šè¿ç®—æ»¡è¶³äº¤æ¢å¾‹å’Œç»“åˆå¾‹
//	å³ï¼šæŒ‰ä¸‹é¢çš„ä»£ç ï¼Œï¼ˆ52542ï¼‰å¾ªç¯è¿ç»­å¼‚æˆ–ï¼Œå¯ä»¥çœ‹ä½œ(5^5)^(2^2)^4 = 0^0^4 = 4
//
// ä½†ä¸‹é¢è¿™ä¸ªå‡½æ•°åœ¨â€œä¸ä¿è¯ä¸€å®šæœ‰è§£â€çš„æƒ…å†µä¸‹æœ‰æ­§ä¹‰ï¼Œé”™è¯¯æ—¶æ— æ³•è¿”å›â€œæ²¡æ‰¾åˆ°åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—â€è¿™ä¸€ä¿¡æ¯
func findSingleNumberInString_XOR(s string) (int, bool) {
	result := 0
	foundAnyDigit := false //ä¸€ä¸ªæ ‡å¿—ï¼Œç”¨äºåˆ¤æ–­å­—ç¬¦ä¸²ä¸­æ˜¯å¦æœ‰æ•°å­—
	for _, r := range s {
		if unicode.IsDigit(r) {
			foundAnyDigit = true
			// å°†å­—ç¬¦æ•°å­—è½¬æ¢ä¸ºæ•´æ•°æ•°å­—
			// '4â€˜çš„ASCIIç å‡å»â€™0â€˜çš„ASCIIç æ­£å¥½ç­‰äº4
			num := int(r - '0')
			result = result ^ num
		}
	}
	if foundAnyDigit {
		return result, true
	}
	return 0, false
}

// ç»ƒä¹ 3 è¾…åŠ©å‡½æ•°ï¼šæŒ‰ç…§æ¯è¡Œå¢åŠ çš„æ ·å¼ï¼Œæ‰“å°ä¸€ä¸ªè·³è¿‡åŒ…å«æ•°å­—6çš„ä¹ä¹ä¹˜æ³•è¡¨
func printMultiplicationTable_Skip6() {
	// å¤–å±‚å¾ªç¯æ§åˆ¶è¡Œï¼ˆç¬¬ä¸€ä¸ªä¹˜æ•°iï¼‰
	for i := 1; i <= 9; i++ {
		// å†…å±‚å¾ªç¯æ§åˆ¶åˆ—ï¼ˆç¬¬äºŒä¸ªä¹˜æ•°jï¼‰
		for j := 1; j <= i; j++ {
			product := i * j

			//å°†ä¸¤ä¸ªä¹˜æ•°è½¬æ¢ä¸ºstr
			iStr := strconv.Itoa(i)
			jStr := strconv.Itoa(j)

			// æ£€æŸ¥i,jçš„å­—ç¬¦ä¸²å½¢å¼ä¸­æ˜¯å¦åŒ…å«"6"
			if strings.Contains(iStr, "6") || strings.Contains(jStr, "6") {
				continue // breakä¼šç»ˆæ­¢æ•´ä¸ªå†…å±‚å¾ªç¯ï¼Œå¦‚æœè¿™å„¿ç”¨break,é‚£ä¹ˆç›´æ¥è·³åˆ°ä¸‹ä¸€ä¸ªiäº†
			}

			// ä½¿ç”¨Printfè¿›è¡Œæ ¼å¼åŒ–è¾“å‡º
			// %-2dç”¨äºä¹˜æ³•ç»“æœçš„å ä½ï¼Œè´Ÿå·è¡¨ç¤ºå·¦å¯¹é½ï¼Œå ä½2ä¸ªå­—ç¬¦å®½åº¦ï¼Œå¯ä»¥è®©ç»“æœæ›´æ•´é½
			// \tè¡¨ç¤ºåˆ¶è¡¨ç¬¦ï¼Œç”¨äºåœ¨å¼å­ä¹‹é—´äº§ç”Ÿè¾ƒå¤§çš„å›ºå®šé—´è·
			fmt.Printf("%dx%d=%-2d\t", j, i, product)

		}
		// æ¯å½“ä¸€è¡Œï¼ˆå†…å±‚å¾ªç¯ç»“æŸï¼‰ï¼Œå°±æ‰“å°ä¸€ä¸ªæ¢è¡Œç¬¦
		if i != 6 {
			fmt.Println()
		}
	}
}

// ç»ƒä¹ 4 è¾…åŠ©å‡½æ•°ï¼šæ‰¾å‡ºæ•°ç»„å’Œä¸­ä¸ºæŒ‡å®šå€¼çš„ä¸¤ä¸ªå…ƒç´ çš„ä¸‹æ ‡
// ä¸€å¼€å§‹çš„æƒ³æ³•ï¼šæš´åŠ›æŸ¥æ‰¾æ³•ï¼Œä¸¤å±‚éå†æ‰€æœ‰çš„ç»„åˆï¼Œå¤–å±‚0åˆ°nï¼Œå†…å±‚i+1åˆ°nï¼Œå¦‚æœå’Œä¸ºæŒ‡å®šå€¼å°±æŠŠ(i,j)å­˜å…¥ç´¢å¼•åˆ‡ç‰‡ä¸­
// ä½†è¿™ç§æ–¹æ³•æ—¶é—´å¤æ‚åº¦æ˜¯O(n^2)ï¼Œæ•ˆç‡è¾ƒä½
// æ›´ä¼˜çš„åšæ³•æ˜¯ä½¿ç”¨å“ˆå¸Œè¡¨ï¼Œæ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦éƒ½ä¸ºO(n)
func findSumPairsHash(arr []int, target int) [][]int {
	// args: arræ˜¯è¾“å…¥çš„æ•´æ•°æ•°ç»„ï¼Œtargetæ˜¯ç›®æ ‡å’Œ
	// return: è¿”å›ä¸€ä¸ªäºŒç»´åˆ‡ç‰‡ï¼ŒåŒ…å«æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„ç´¢å¼•å¯¹
	var result [][]int

	// 1.åˆ›å»ºä¸€ä¸ªmapï¼Œkeyæ˜¯æ•°å­—ï¼Œvalueæ˜¯ç´¢å¼•
	seen := make(map[int]int)

	// 2.å•å±‚å¾ªç¯éå†æ•°ç»„
	for i, num := range arr {
		// è®¡ç®—éœ€è¦çš„â€œå¦ä¸€åŠâ€
		complement := target - num

		// åœ¨mapä¸­æŸ¥æ‰¾complementæ˜¯å¦å­˜åœ¨
		if j, found := seen[complement]; found {
			// å¦‚æœæ‰¾åˆ°äº†ï¼Œè¯´æ˜nums[j] + nums[i] == target
			// æˆ‘ä»¬å°±æ‰¾åˆ°äº†ä¸€ä¸ªè§£(j,i)
			result = append(result, []int{j, i})
		}

		//æ— è®ºæ‰¾æ²¡æ‰¾åˆ°ï¼Œéƒ½æŠŠå½“å‰æ•°å­—å’Œå®ƒçš„ç´¢å¼•å­˜å…¥mapï¼Œä¾›åé¢å…ƒç´ è¿›è¡ŒæŸ¥æ‰¾
		seen[num] = i
	}
	return result
}

// ç»ƒä¹ 5 è¾…åŠ©å‡½æ•° ç»Ÿè®¡ä¸€ä¸ªä¸­è‹±æ–‡æ··åˆå­—ç¬¦ä¸²ä¸­ï¼Œæ¯ä¸ªè‹±æ–‡å•è¯å’Œä¸­æ–‡æ±‰å­—çš„å‡ºç°æ¬¡æ•°
// ä»£ç å®ç°ç­–ç•¥
//   1.ç»Ÿä¸€çš„è®¡æ•°å™¨ï¼šåˆ›å»ºä¸€ä¸ªmap[string]int æ¥å­˜å‚¨æ‰€æœ‰ç»“æœï¼Œå› ä¸ºæ— è®ºæ˜¯å•è¯è¿˜æ˜¯æ±‰å­—éƒ½å¯ä»¥ç”¨stringè¡¨ç¤ºï¼Œæ— éœ€åˆ†å¼€åˆ›å»ºå­—å…¸
//   2.å•è¯ç´¯ç§¯å™¨ï¼ˆğŸ”›ï¼‰ï¼šä½¿ç”¨strings.Builderæ¥é«˜æ•ˆåœ°æ‹¼æ¥è‹±æ–‡å­—ç¬¦ï¼Œå½¢æˆå•è¯
//   3.é€Runeéå†ï¼šä½¿ç”¨for _,r := range str éå†å­—ç¬¦ä¸²
//   4.åˆ†ç±»å¤„ç†ï¼š
//      - å¦‚æœræ˜¯æ±‰å­—ï¼ˆunicode.IsHan):
//        - é¦–å…ˆï¼Œæ£€æŸ¥å•è¯ç´¯ç§¯å™¨(strings.Builder)ä¸­æ˜¯å¦æœ‰å†…å®¹ï¼Œå¦‚æœæœ‰ï¼Œè¯´æ˜ä¸€ä¸ªè‹±æ–‡æ¡£æ¬¡åˆšç»“æŸï¼Œéœ€è¦å°†å…¶å­˜å…¥mapå¹¶æ¸…ç©ºç´¯ç§¯å™¨
// 	  - å°†å½“å‰æ±‰å­—ä½œä¸ºstringç›´æ¥å­˜å…¥mapä¸­
// 	- å¦‚æœræ˜¯å­—æ¯ï¼š
// 	  - å°†è¿™ä¸ªå­—æ¯runeæ·»åŠ åˆ°å•è¯ç´¯ç§¯å™¨ä¸­
// 	- å¦‚æœræ˜¯å…¶ä»–å­—ç¬¦ï¼ˆç©ºæ ¼ï¼Œæ ‡ç‚¹ç­‰ï¼‰ï¼š
// 	  - æŠŠå®ƒçœ‹ä½œæ˜¯ä¸€ä¸ªâ€œå•è¯è¾¹ç•Œâ€ï¼Œæ£€æŸ¥å•è¯ç´¯ç§¯å™¨ä¸­æ˜¯å¦æœ‰å†…å®¹ï¼Œå¦‚æœæœ‰ï¼Œå¤„ç†å®ƒå¹¶æ¸…ç©ºç´¯ç§¯å™¨
//  5.æ”¶å°¾å·¥ä½œï¼šå¾ªç¯ç»“æŸåï¼Œå•è¯ç´¯ç§¯å™¨ä¸­å¯èƒ½è¿˜ç•™ç€æœ€åä¸€ä¸ªè‹±æ–‡å•è¯ï¼ˆå¦‚æœå­—ç¬¦ä¸²ä»¥è‹±æ–‡å•è¯ç»“å°¾ï¼‰ï¼Œéœ€è¦åšä¸€æ¬¡æœ€ç»ˆçš„æ£€æŸ¥ä¸å¤„ç†

func countWordsAndChars(s string) map[string]int {
	// 1.ä½¿ç”¨ä¸€ä¸ªmapç»Ÿä¸€å­˜å‚¨ç»“æœ
	counts := make(map[string]int)

	// 2.ä½¿ç”¨strings.Builder ç›¸æ¯”åŠ å·ï¼ˆs = s +"a" + "b")ï¼Œæ›´èƒ½é«˜æ•ˆç´¯ç§¯è‹±æ–‡å•è¯
	var wordBuilder strings.Builder

	// å®šä¹‰ä¸€ä¸ªå†…éƒ¨å‡½æ•°/é—­åŒ…ï¼Œç”¨äºå¤„ç†ç´¯ç§¯å™¨çš„å•è¯ï¼Œé¿å…ä»£ç é‡å¤
	processWord := func() {
		word := wordBuilder.String()
		if word != "" { //å¦‚æœå•è¯ç´¯ç§¯å™¨é‡Œä¸ä¸ºç©º
			counts[strings.ToLower(word)]++ // å°†å•è¯è½¬ä¸ºå°å†™ï¼Œå®ç°ä¸åŒºåˆ†å¤§å°å†™è®°æ•°
			wordBuilder.Reset()             // æ¸…ç©ºç´¯ç§¯å™¨

		}
	}

	// 3.é€ä¸ªRuneéå†å­—ç¬¦ä¸²å¹¶åˆ†ç±»å¤„ç†
	for _, r := range s {
		if unicode.Is(unicode.Han, r) {
			processWord()       // é‡åˆ°æ±‰å­—ä»£è¡¨å•è¯ç´¯ç§¯ç»“æŸï¼Œéœ€è¦å¤„ç†ä¸€ä¸‹ç´¯ç§¯å™¨é‡Œçš„å•è¯äº†
			counts[string(r)]++ // å¼ºåˆ¶ç±»å‹è½¬æ¢å¹¶å……å½“å­—å…¸çš„key

		} else if unicode.IsLetter(r) {
			wordBuilder.WriteRune(r) // å¦‚æœæ˜¯å­—æ¯ï¼ŒåŠ å…¥å•è¯ç´¯ç§¯å™¨
		} else {
			processWord() //å¦‚æœæ˜¯ç©ºæ ¼ï¼Œæ ‡ç‚¹ç­‰ï¼Œè§†ä¸ºå•è¯è¾¹ç•Œï¼Œå¤„ç†ç´¯ç§¯çš„è‹±æ–‡å•è¯
		}
	}

	processWord() // æ”¶å°¾å·¥ä½œ

	return counts
}

// ç»ƒä¹ å…­ï¼šé—­åŒ…å‡½æ•°
// é—­åŒ…å°±æ˜¯ä¸€ä¸ªå‡½æ•°å’Œå®ƒèƒ½è®¿é—®çš„ç¯å¢ƒå˜é‡ï¼ˆåœ¨å®ƒå¤–é¢å®šä¹‰çš„å˜é‡ï¼‰çš„ç»„åˆä½“ã€‚å³ä½¿å¤–éƒ¨å‡½æ•°å·²ç»æ‰§è¡Œå®Œäº†ï¼Œè¿™ä¸ªå†…éƒ¨å‡½æ•°ä»ç„¶èƒ½è®°ä½å¹¶æ“ä½œé‚£äº›å¤–éƒ¨å˜é‡
// é—­åŒ…å¯ä»¥ç”¨æ¥åˆ›å»ºä¸€ç³»åˆ—åŠŸèƒ½ç›¸ä¼¼ä½†æ˜¯é…ç½®ä¸åŒçš„å‡½æ•°
// makeGreeteræ˜¯ä¸€ä¸ªå‡½æ•°å·¥å‚ï¼Œå®ƒæ¥å—ä¸€ä¸ªå‰ç¼€ï¼ˆæ±‰è¯­åæˆ–è‹±è¯­åï¼‰ï¼Œç„¶åç”Ÿäº§å‡ºæ±‰è¯­/è‹±è¯­çš„é—®å€™å‡½æ•°
func makeGreeter(prefix string) func(string) string {
	//è¿”å›çš„å‡½æ•°æ˜¯ä¸€ä¸ªé—­åŒ…ï¼Œå®ƒæ•è·äº†å¤–éƒ¨å˜é‡prefix
	return func(name string) string {
		return prefix + "," + name
	}
}

// ç»ƒä¹ ä¸ƒï¼šåˆ†é…é‡‘å¸
// ä½ æœ‰50æšé‡‘å¸ï¼Œéœ€è¦åˆ†é…ç»™ä»¥ä¸‹å‡ ä¸ªäººï¼šMatthew,Sarah,Augustus,Heidi,Emilie,Peter,Giana,Adriano,Aaron,Elizabethã€‚
// åˆ†é…è§„åˆ™å¦‚ä¸‹ï¼š
// a. åå­—ä¸­æ¯åŒ…å«1ä¸ª'e'æˆ–'E'åˆ†1æšé‡‘å¸
// b. åå­—ä¸­æ¯åŒ…å«1ä¸ª'i'æˆ–'I'åˆ†2æšé‡‘å¸
// c. åå­—ä¸­æ¯åŒ…å«1ä¸ª'o'æˆ–'O'åˆ†3æšé‡‘å¸
// d: åå­—ä¸­æ¯åŒ…å«1ä¸ª'u'æˆ–'U'åˆ†4æšé‡‘å¸
// å†™ä¸€ä¸ªç¨‹åºï¼Œè®¡ç®—æ¯ä¸ªç”¨æˆ·åˆ†åˆ°å¤šå°‘é‡‘å¸ï¼Œä»¥åŠæœ€åå‰©ä½™å¤šå°‘é‡‘å¸ï¼Ÿ
var (
	coins = 30
	users = []string{
		"Matthew", "Sarah", "Augustus", "Heidi", "Emilie", "Peter", "Giana", "Adriano", "Aaron", "Elizabeth",
	}
	distribution = make(map[string]int, len(users))
)

//æ€è·¯ï¼š
// 1.åœ¨dispatchCoinå‡½æ•°å¼€å§‹æ—¶ï¼Œå®šä¹‰ä¸€ä¸ªåˆ†é…é‡‘å¸æ€»æ•°çš„å˜é‡
// 2.åœ¨å‡½æ•°å¼€å¤´ä½¿ç”¨deferå®‰æ’ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œç”¨äºåœ¨æœ€åæ‰“å°å‡ºå®Œæ•´çš„distribution mapï¼Œä½œä¸ºä¸€ä»½è¯¦ç»†çš„åˆ†é…æŠ¥å‘Š
// 3,å¼€å§‹éå†usersåˆ‡ç‰‡ï¼Œå¯¹äºæ¯ä¸€ä¸ªname:
//    .å®šä¹‰ä¸€ä¸ªå˜é‡personCoinsç”¨äºè®¡ç®—å½“å‰è¿™ä¸ªäººçš„é‡‘å¸æ•°ï¼Œåˆå§‹åŒ–ä¸º0
//    .éå†nameå­—ç¬¦ä¸²ä¸­çš„æ¯ä¸€ä¸ªå­—ç¬¦(rune) è¿™ä¸¤ä¸ªéå†éƒ½ç”¨rangeéå†
//    .å¯¹äºæ¯ä¸€ä¸ªå­—ç¬¦ï¼Œä½¿ç”¨switchè¯­å¥æ¥åˆ¤æ–­ï¼Œæ˜¯ä»€ä¹ˆå­—æ¯ï¼ŒåŠ å¤šå°‘é‡‘å¸
//    .å†…å±‚å¾ªç¯ï¼ˆå­—ç¬¦éå†ï¼‰ç»“æŸåï¼ŒpersonCoinså°±æ˜¯è¿™ä¸ªäººåº”å¾—çš„é‡‘å¸æ€»æ•°ï¼Œå­˜å…¥å­—å…¸ï¼Œå¹¶æ›´æ–°å·²åˆ†é…çš„é‡‘å¸æ€»æ•°
// 4.å¤–å±‚å¾ªç¯ï¼ˆç”¨æˆ·éå†ï¼‰ç»“æŸåï¼Œè®¡ç®—å‰©ä½™é‡‘å¸ï¼Œè¿”å›å‰©ä½™å€¼

func dispatchCoin(users []string, coins int, distribution map[string]int) (int, error) {
	//å®šä¹‰ä¸€ä¸ªç´¯è®¡å·²åˆ†é…é‡‘å¸çš„å˜é‡
	totalDistributed := 0

	//ä½¿ç”¨deferåœ¨å‡½æ•°é€€å‡ºå‰æ‰“å°æœ€ç»ˆçš„åˆ†é…è¯¦æƒ… å¯ä»¥æŠŠdeferå½“ä½œâ€œç¨åå¤„ç†â€çš„ä¾¿ç­¾
	defer func() {
		fmt.Println("===== åˆ†é…è¯¦æƒ… =====")
		for name, amount := range distribution {
			fmt.Printf("%s:%d\n", name, amount)
		}
		fmt.Println("=========")
	}() // æœ€åè¿™ä¸ªæ‹¬å·æ˜¯å‡½æ•°è°ƒç”¨æ“ä½œç¬¦ï¼Œæ„æ€æ˜¯ï¼šæ‰§è¡Œè¿™ä¸ªå‡½æ•° deferå‡½æ•°çš„å®Œæ•´å®šä¹‰ï¼šdefer func() { ... }()

	// 1.éå†æ‰€æœ‰ç”¨æˆ·
	for _, name := range users {
		personalCoins := 0 // å®šä¹‰ä¸ªäººçš„åˆ†é…æ•°é‡
		// 2.éå†å½“å‰ç”¨æˆ·åçš„æ¯ä¸€ä¸ªå­—ç¬¦
		for _, rune := range name {
			switch rune {
			case 'e', 'E':
				personalCoins += 1
			case 'i', 'I':
				personalCoins += 2
			case 'o', 'O':
				personalCoins += 3
			case 'u', 'U':
				personalCoins += 4
			}
		}
		// 3.å°†è®¡ç®—å‡ºçš„ä¸ªäººé‡‘å¸æ•°å­˜å…¥å­—å…¸
		distribution[name] = personalCoins
		// 4.ç´¯åŠ åˆ°æ€»åˆ†é…é‡‘å¸æ•°ä¸­
		totalDistributed += personalCoins
	}

	// ä»¥ä¸‹æ˜¯é”™è¯¯å¤„ç†ï¼šå¦‚æœåˆ†é…çš„é‡‘å¸è¶…è¿‡äº†é‡‘å¸æ€»æ•°
	// è¿™é‡Œå¯ä»¥ç”¨panicå’Œrecoverï¼Œä½†æ˜¯ä¼šè¢«è®¤ä¸ºæ˜¯æ»¥ç”¨
	//  panicè¢«è®¾è®¡ç”¨æ¥å¤„ç†çœŸæ­£ç¾éš¾æ€§çš„ï¼Œç¨‹åºæ— æ³•ç»§ç»­æ­£å¸¸è¿è¡Œçš„é”™è¯¯ï¼Œå…¸å‹ä¾‹å¦‚æ•°ç»„è¶Šç•Œï¼Œç©ºæŒ‡é’ˆå¼•ç”¨
	// è¿™é‡Œå¯ä»¥ç”¨errorè¿”å›å€¼ï¼Œerrorè¢«è®¾è®¡ç”¨æ¥å¤„ç†å¯é¢„æœŸçš„ï¼Œä¸šåŠ¡é€»è¾‘èŒƒå›´å†…çš„å¤±è´¥æƒ…å†µï¼Œå…¸å‹ä¾‹å¦‚æ ¼å¼é”™è¯¯ï¼Œæ‰“å¼€ä¸å­˜åœ¨æ–‡ä»¶ï¼Œç½‘ç»œè¶…æ—¶ç­‰
	//   erroræ˜¯ç¨‹åºæ­£å¸¸è¿è¡Œä¸­å¯èƒ½é‡åˆ°çš„â€œéæˆåŠŸâ€çŠ¶æ€
	if totalDistributed > coins {
		// åˆ›å»ºä¸€ä¸ªerrorå¯¹è±¡
		err := fmt.Errorf("é‡‘å¸ä¸è¶³ï¼éœ€è¦%d,ä½†åªæœ‰%d", totalDistributed, coins)
		return 0, err //è¿™ä¸ªå¤§å‡½æ•°éœ€è¦å®šä¹‰ä¸€ä¸ªerrorè¿”å›ç±»å‹ï¼Œå‡ºé”™è¿”å›errorå¯¹è±¡ï¼Œä¸å‡ºé”™è¿”å›nil
	}
	return coins - totalDistributed, nil
}
